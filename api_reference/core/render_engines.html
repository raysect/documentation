

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1.5. Render Engines &mdash; Raysect Documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/RaysectLogo_web.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.6. Utilities" href="utilities.html" />
    <link rel="prev" title="1.4. Spatial Acceleration" href="spatial_acceleration.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Raysect
          

          
            
            <img src="../../_static/RaysectLogo_web.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.7.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">2. License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">3. Downloading and Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how_it_works.html">4. How it works</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart_guide.html">5. Quickstart Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../observers.html">6. Sampling and Observers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../primitives.html">7. Primitives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../materials.html">8. Materials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../conventions.html">9. Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">10. References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">11. Glossary</a></li>
</ul>
<p class="caption"><span class="caption-text">Demonstrations</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../demonstrations/demonstrations.html">1. Core Functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../demonstrations/demonstrations.html#materials">2. Materials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../demonstrations/demonstrations.html#observers">3. Observers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../demonstrations/demonstrations.html#optics">4. Optics</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="core.html">1. Raysect Core</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="core_classes.html">1.1. Core Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="math.html">1.2. Math Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="raysect_core_scenegraph.html">1.3. Scenegraph Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spatial_acceleration.html">1.4. Spatial Acceleration</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">1.5. Render Engines</a></li>
<li class="toctree-l2"><a class="reference internal" href="utilities.html">1.6. Utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../primitives/primitives.html">2. Primitives Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optical/optical.html">3. Optical Module</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Raysect</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="core.html"><span class="section-number">1. </span>Raysect Core</a> &raquo;</li>
        
      <li><span class="section-number">1.5. </span>Render Engines</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/api_reference/core/render_engines.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="render-engines">
<h1><span class="section-number">1.5. </span>Render Engines<a class="headerlink" href="#render-engines" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="raysect.core.workflow.RenderEngine">
<em class="property">class </em><code class="sig-prename descclassname">raysect.core.workflow.</code><code class="sig-name descname">RenderEngine</code><a class="reference internal" href="../../_modules/raysect/core/workflow.html#RenderEngine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#raysect.core.workflow.RenderEngine" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides a common rendering workflow interface.</p>
<p>This is a base class, its functionality must be implemented fully by the deriving class.</p>
<p>This class provides a rendering workflow that abstracts away the underlying
system performing the work. It is intended that render engines may be built
that provide rendering on single cores, multi-cores (SMP) and clusters.</p>
<p>The basic workflow is as follows. The render task is split into small,
self-contained chunks of work - ‘tasks’. These tasks are passed to the
render engine which distributes the work to the available computing
resources. These discrete computing resources are know as “workers”.
Workers process one task at a time and return their result to the render
engine. When results are received the render engine assembles them into
the final result.</p>
<p>This workflow is implemented by supplying a set of tasks and two methods to
the render engines’ run() method which processes those tasks. The functions
supplied to the run() method may be given additional args and kwargs.</p>
<p>A worker calls render for each task object received. render has the following signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="o">*</span><span class="n">render_args</span><span class="p">,</span> <span class="o">**</span><span class="n">render_kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>where args and kwargs are additional arguments supplied by the user.</p>
<p>Similarly, the worker calls update() for the results generated by a call to
render(). Update() has the following signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="o">*</span><span class="n">update_args</span><span class="p">,</span> <span class="o">**</span><span class="n">update_kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>where args and kwargs are additional arguments supplied by the user.</p>
<p>The render() function must return an object representing the results,
this must be a picklable python object.</p>
<p>The execution order of tasks is not guaranteed to be in order. If the order
is critical, an identifier should be passed as part of the task definition
and returned in the result. This will permit the order to be reconstructed.</p>
<dl class="py method">
<dt id="raysect.core.workflow.RenderEngine.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tasks</span></em>, <em class="sig-param"><span class="n">render</span></em>, <em class="sig-param"><span class="n">update</span></em>, <em class="sig-param"><span class="n">render_args</span><span class="o">=</span><span class="default_value">()</span></em>, <em class="sig-param"><span class="n">render_kwargs</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">update_args</span><span class="o">=</span><span class="default_value">()</span></em>, <em class="sig-param"><span class="n">update_kwargs</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/raysect/core/workflow.html#RenderEngine.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#raysect.core.workflow.RenderEngine.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Starts the render engine executing the requested tasks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tasks</strong> (<em>list</em>) – List of user defined tuples that describe the task to execute.</p></li>
<li><p><strong>render</strong> (<em>object</em>) – Callable python object that executes the tasks.</p></li>
<li><p><strong>update</strong> (<em>object</em>) – Callable python object that is called following a render task and must be
used to update the internal state of the object requesting work.</p></li>
<li><p><strong>render_args</strong> (<em>tuple</em>) – Additional arguments to pass to user defined render function.</p></li>
<li><p><strong>render_kwargs</strong> (<em>tuple</em>) – Additional keyword arguments to pass to user defined render function.</p></li>
<li><p><strong>update_args</strong> (<em>tuple</em>) – Additional arguments to pass to user defined update function.</p></li>
<li><p><strong>update_kwargs</strong> (<em>tuple</em>) – Additional keyword arguments to pass to user defined update function.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="raysect.core.workflow.RenderEngine.worker_count">
<code class="sig-name descname">worker_count</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/raysect/core/workflow.html#RenderEngine.worker_count"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#raysect.core.workflow.RenderEngine.worker_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of workers in use by this engine.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="raysect.core.workflow.SerialEngine">
<em class="property">class </em><code class="sig-prename descclassname">raysect.core.workflow.</code><code class="sig-name descname">SerialEngine</code><a class="reference internal" href="../../_modules/raysect/core/workflow.html#SerialEngine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#raysect.core.workflow.SerialEngine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#raysect.core.workflow.RenderEngine" title="raysect.core.workflow.RenderEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">raysect.core.workflow.RenderEngine</span></code></a></p>
<p>Render engine for running on a single CPU processor.</p>
<p>This engine is useful for debugging.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">raysect.core</span> <span class="kn">import</span> <span class="n">SerialEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">raysect.optical.observer</span> <span class="kn">import</span> <span class="n">PinholeCamera</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">camera</span> <span class="o">=</span> <span class="n">PinholeCamera</span><span class="p">((</span><span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">camera</span><span class="o">.</span><span class="n">render_engine</span> <span class="o">=</span> <span class="n">SerialEngine</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt id="raysect.core.workflow.MulticoreEngine">
<em class="property">class </em><code class="sig-prename descclassname">raysect.core.workflow.</code><code class="sig-name descname">MulticoreEngine</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">processes</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tasks_per_job</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/raysect/core/workflow.html#MulticoreEngine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#raysect.core.workflow.MulticoreEngine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#raysect.core.workflow.RenderEngine" title="raysect.core.workflow.RenderEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">raysect.core.workflow.RenderEngine</span></code></a></p>
<p>A render engine for distributing work across multiple CPU cores.</p>
<p>The number of processes spawned by this render engine is controlled via
the processes attribute. This can also be set at object initialisation.</p>
<p>If the processes attribute is set to None (the default), the render engine
will automatically set the number of processes to be equal to the number
of CPU cores detected on the machine.</p>
<p>If a render is being performed where the time to compute an individual task
is comparable to the latency of the inter process communication (IPC), the
render may run significantly slower than expected due to waiting for the
IPC to complete. To reduce the impact of the IPC overhead, multiple tasks
are grouped together into jobs, requiring only one IPC wait for multiple
tasks.</p>
<p>By default the number of tasks per job is adjusted automatically. The
tasks_per_job attribute can be used to override this automatic adjustment.
To reenable the automated adjustment, set the tasks_per_job attribute to
None.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>processes</strong> – The number of worker processes, or None to use all available cores (default).</p></li>
<li><p><strong>tasks_per_job</strong> – The number of tasks to group into a single job, or None if this should be determined automatically (default).</p></li>
</ul>
</dd>
</dl>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">raysect.core</span> <span class="kn">import</span> <span class="n">MulticoreEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">raysect.optical.observer</span> <span class="kn">import</span> <span class="n">PinholeCamera</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">camera</span> <span class="o">=</span> <span class="n">PinholeCamera</span><span class="p">((</span><span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">))</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># allowing the camera to use all available CPU cores.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">camera</span><span class="o">.</span><span class="n">render_engine</span> <span class="o">=</span> <span class="n">MulticoreEngine</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># or forcing the render engine to use a specific number of CPU processes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">camera</span><span class="o">.</span><span class="n">render_engine</span> <span class="o">=</span> <span class="n">MulticoreEngine</span><span class="p">(</span><span class="n">processes</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="utilities.html" class="btn btn-neutral float-right" title="1.6. Utilities" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="spatial_acceleration.html" class="btn btn-neutral float-left" title="1.4. Spatial Acceleration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014-2018, Dr Alex Meakins

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>